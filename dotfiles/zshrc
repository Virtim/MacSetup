# shellcheck shell=bash
# MacSetup ZSH Configuration
# This file is managed in the MacSetup repository
# System ~/.zshrc should source this file

# Determine dotfiles directory
DOTFILES_DIR="${0:A:h}"  # Directory containing this file

# Path to your oh-my-zsh installation
export ZSH="$HOME/.oh-my-zsh"

# Oh My Zsh theme
# shellcheck disable=SC2034
ZSH_THEME="robbyrussell"

# History settings
# shellcheck disable=SC2034
HIST_STAMPS='mm/dd/yyyy'

# Oh My Zsh plugins
# shellcheck disable=SC2034
plugins=(git)

# Load Oh My Zsh if installed
# shellcheck disable=SC1091
[[ -d "$ZSH" ]] && source "$ZSH/oh-my-zsh.sh"

# Load common configuration (cross-platform)
# shellcheck disable=SC1091
[[ -f "$DOTFILES_DIR/common.sh" ]] && source "$DOTFILES_DIR/common.sh"

# Load common aliases
# shellcheck disable=SC1091
[[ -f "$DOTFILES_DIR/common-aliases.sh" ]] && source "$DOTFILES_DIR/common-aliases.sh"

# Load common functions
# shellcheck disable=SC1091
[[ -f "$DOTFILES_DIR/common-functions.sh" ]] && source "$DOTFILES_DIR/common-functions.sh"

# Load macOS-specific configuration if on macOS
# shellcheck disable=SC1091
[[ "$(uname)" == "Darwin" ]] && [[ -f "$DOTFILES_DIR/macos.sh" ]] && source "$DOTFILES_DIR/macos.sh"

# Load company/job-specific configuration from ~/.company/
# All .sh files in ~/.company/ are automatically sourced
# This directory lives outside the repo to keep company configs separate
if [[ -d "$HOME/.company" ]]; then
  for company_config in "$HOME/.company"/*.sh; do
    # shellcheck disable=SC1090
    [[ -f "$company_config" ]] && source "$company_config"
  done
fi

# Load local configuration (not tracked in git - for secrets/private config)
# This loads last so it can override any previous settings
# shellcheck disable=SC1091
[[ -f "$DOTFILES_DIR/local.zsh" ]] && source "$DOTFILES_DIR/local.zsh"

# Bash completion support
autoload -U +X bashcompinit && bashcompinit

# ZSH syntax highlighting (if installed via Homebrew on macOS)
if [[ "$(uname)" == "Darwin" ]]; then
  # shellcheck disable=SC1091
  [[ -f "/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ]] && \
    source /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi
